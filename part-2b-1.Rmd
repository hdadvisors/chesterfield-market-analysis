# (PART) CORRIDOR CASE STUDIES {.unnumbered}

# Route 1 corridor analysis {#part-2b-1}

This section describes the Route 1 corridor in terms of its rental housing market, proximity of rental homes to amenities, recent major investments, and homeownership relative to the price of single-family rentals.

The Route 1 corridor used in this section uses the same six census tracts from the previous Route 1 affordability analysis in [Chapter 10](#part-1b-5).

```{r setup}

library(tidycensus)
library(tidyverse)
library(janitor)
library(leaflet)
library(sf)
library(sp)
library(tigris)
library(mapview)
library(simplevis)
library(readxl)
library(ggplot2)
library(lubridate)
library(viridis)
library(tidygeocoder)

```
## The Route One Corridor

U.S Route 1 once served as the major north-south corridor that connected East Coast states. However, the
completion of Interstate 95 in the late 1950s drew traffic and business away from the highway. Since then,
areas up and down the entirety of U.S. Route 1 have experienced decline and significant change that present
challenges to revitalization. As a home to residents and businesses, the Route 1 corridor in Chesterfield County is well-positioned to be one of the county’s most vibrant suburban communities to existing and future generations. In close proximity to the City of Richmond and with convenient access to Interstate 95, the corridor is centrally located in the Richmond metro area and could play a pivotal role in the growth and development of the entire region.

Current conditions on the northern section of Route 1 prevent significant reinvestment, but recent efforts by the County improve those conditions and incentivize new and much needed development. The 2018 Northern Jefferson Davis Special Area Plan and the 2019 Northern Jefferson Davis Real Estate Market Study provide Chesterfield County with initial tools to revitalize Route 1. Momentum has continued with the Route 1 Residential Overlay District, the Northern Jefferson Davis Incentive Program, and Greater Richmond Transit Company’s Pilot Bus Service. 

Much of the new rental housing development has occurred at the southern end of the study area --- pulled towards the intersection of W. Hundred Road (State Route 10) and Route 1, where there is a dense concentration of retail shopping options. 

This study focuses its research on the six census tracts that straddle the Route 1 corridor from the Richmond-Chesterfield County border to the north and State Route 10 to the south. 


```{r route-one-map}

r1_tracts_list <- c("100300", "100404", "100405", "100406", "100407", "100409")

r1_tracts <- tracts("VA", "Chesterfield",
                    progress_bar = FALSE) %>% 
  filter(TRACTCE %in% r1_tracts_list) %>% 
  st_transform(4326)

leaf_sf(r1_tracts)

```
## Rental housing supply

The following describes the existing rental housing supply along the Route 1 corridor.

### Number of rental homes

The number of rental homes along the Route 1 corridor has increased by 26 percent between 2010 and 2020 - a total of 708 renter households. Much of this rental housing growth occurred in the latter half of the decade --- from 2014 and on. From 2010 to 2012, rental housing was in decline --- most likely a reflection of the latter year impacts from the Great Recession. During this timeframe, the construction industry struggled to keep pace with the growing demand for new rental housing. From 2019 to 2020, there was a higher estimated percent change (13 percent)in renter homes than in previous years. Although this could be a significant impact of the COVID-19's impact on the rental housing market --- margins of error for the data in 2020 are also higher than previous years; and therefore, these changes should be interpreted with caution.

```{r r1-rhh}

years <- 2010:2020

b25003_vars <- load_variables(2020, "acs5") |> 
  filter(str_sub(name, end = 7) %in% "B25003_")

b25003_raw <- map_dfr(years, function(yr){
  b25003_pull <- get_acs(
    geography = "tract",
    county = "Chesterfield County",
    state = "VA",
    table = "B25003",
    year = yr,
    survey = "acs5",
    cache_table = TRUE,
    geometry = TRUE
  ) |> 
    mutate(year = yr)
  })

b25003_r1_raw <- b25003_raw |> 
  subset(GEOID %in% r1_tracts$GEOID)

b25003_vars_cleaned <- b25003_vars |> 
  separate(label, into = c("est", "total", "tenure"), sep = "!!") |> 
  select(variable = name, tenure) |> 
  drop_na() |> 
  mutate(tenure = case_when(
    tenure == "Owner occupied" ~ "Homeowner",
    tenure == "Renter occupied" ~ "Renter"
  )) |> 
  filter(tenure == "Renter")

b25003_r1 <- b25003_r1_raw |> 
  right_join(b25003_vars_cleaned, by = "variable") |> 
  select(NAME, fips = GEOID, year, tenure, estimate, moe)

b25003_route1 <- b25003_r1 |> 
  group_by(year) |> 
  summarise(estimate = sum(estimate))
  
#Create line graph showing change in renter households across time.
r1_renters_plot <- gg_line(
  b25003_route1,
  x_var = year,
  y_var = estimate,
  y_breaks_n = 5,
  title = "Renter households",
  x_title = element_blank())

plotly::ggplotly(r1_renters_plot) %>% 
  plotly_camera()

  
```

Based on 2010 and 2020 estimates, the increase in rental housing has largely occurred at the northern end of the Route 1 corridor in the Ampthill area. All areas saw some increase in renter housing except for Census Tract 1004.04, which covers the eastern side of Route 1 from Falling Creek down to Bellwood Road. This census tract experienced a decrease of 180 renter households. While unable to determine the causes or from where these renter households came from, this area of Route 1 contains several manufactured home communities and naturally-occurring affordable housing --- all of which place households at greater risk of displacement.


```{r r1-rhh-map-10}

b25003_r1_10 <- b25003_r1 |> 
  filter(year == 2010) |> 
  select(NAME, fips, year, estimate)

b25003_r1_20 <- b25003_r1 |> 
  filter(year == 2020) |> 
  select(NAME, fips, year, estimate)

b25003_r1_10_20 <- cbind(b25003_r1_10, b25003_r1_20) |> 
  select(NAME, fips, est10 = estimate, est20 = estimate.1, geometry) |> 
  mutate(change = (est20-est10))



```


#### Multifamily properties

Of the estimated 3,376 occupied rental homes from the U.S. Census Bureau, CoStar captures at most 2,417 of them that are located across 20 multifamily properties. These multifamily properties contain at least 12 rental homes and the majority of these properties (70 percent) are garden-style apartments. The majority (70 percent) of existing properties were built before 1976, and of these fourteen properties, only two have a recorded renovation --- Collindale Apartments (renovated in 1990) and Falling Creek (renovated in 2017).

```{r costar-mf-1, fig.cap= "Total number of multifamily units by property status"}

# Load .csv of CoStar properties. Data was collected by hand drawing boundaries for the necessary census tracts in the CoStar platform. No filters were placed on the search aside from multi-family property.

costar_r1_mf <- read_csv("data/costar_r1_mf.csv") |> 
  clean_names() |> 
  filter(property_address != "8219 Jefferson Davis Hwy") |> 
  filter(property_address != "9608 Jefferson Davis Hwy") |> 
  filter(property_address != "2537 Norcliff Rd") |> 
  filter(property_address != "12329-12331 Jefferson Davis Hwy") |> 
  filter(property_address != "9701 Jefferson Davis Hwy")

r1_unit_cnt <- costar_r1_mf |> 
  group_by(building_status) |> 
  summarise(units = sum(number_of_units))

r1_unit_cnt_bar <- gg_bar_col(
  r1_unit_cnt,
  x_var = building_status,
  y_var = units,
  col_var = building_status
)

plotly::ggplotly(r1_unit_cnt_bar) %>% 
  plotly_camera()

```

The city-county border was located much further north before the annexation of Northern Chesterfield by the City of Richmond in 1970. In spite of this change, these older rental properties represent the extent to which rental housing development in the mid-20th century stretched into the county. 


```{r costar-mf-2, fig.cap="Map of multifamily properties along Route One Corridor"}

r1_map <- costar_r1_mf |> 
  st_as_sf(coords = c("longitude", "latitude"), crs=4326, remove=FALSE)

leaflet(r1_map) |> 
  addTiles() |> 
  addCircleMarkers(
    radius = 3) |> 
  addPolygons(data=r1_tracts, weight = 2, fillColor = NULL)


```
- Manufactured home communities

```{r mhc-r1}

# Use MHCCV study instead; supplement additional MHCs.

mhc <- read_csv("data/mhccv_chesterfield.csv") 

mhc <- mhc |> 
  transform(fulladdress = paste(mhc$address, mhc$county, mhc$state, mhc$zip, sep = ", "))|> 
  select(name, fulladdress, units, units_mhccv, corridor)

mhc_coded <- mhc |> 
  geocode(address = fulladdress,
          method = 'geocodio',
          full_results = TRUE,
          unique_only = FALSE,
          lat = Latitude,
          long = Longitude)

mhc_coded <- mhc_coded |> 
  mutate(Latitude = case_when(
    name == "Holiday Mobile Home Park" ~ 37.393355,
    TRUE ~ Latitude
  )) |> 
  mutate(Longitude = case_when(
    name == "Holiday Mobile Home Park" ~ -77.427561,
    TRUE ~ Longitude
  ))

mhc_coded_r1 <- mhc_coded |> 
  filter(corridor == "Route 1 - N")


leaflet(mhc_coded_r1) |> 
  addTiles() |> 
  addCircleMarkers(
    radius = ~ (units_mhccv/5),
    color = "orange",
    stroke = FALSE, fillOpacity = 0.5
  )



```

- Estimated single-family rentals (county data)

```{r sfr-r1}

sfr_r1 <- ch_sfh |> 
  st_join(left = FALSE, r1_tracts["NAMELSAD"]) |> 
  select(address, year_built, improvement, ownership, NAMELSAD, geometry)

sfr_r1_summary <- sfr_r1 |> 
  group_by(NAMELSAD, ownership) |> 
  summarise(count = n_distinct(address)) |> 
  mutate(total_sfh = case_when(
    NAMELSAD == NAMELSAD ~ sum(count))
  ) |> 
  mutate(percent_sfh = count/total_sfh) |> 
  filter(ownership == "Renter-occupied SFH") |> 
  st_drop_geometry()

sfr_r1_tracts <- r1_tracts |> 
  left_join(sfr_r1_summary, by = "NAMELSAD")

leaf_sf_col(sfr_r1_tracts,
            col_var = percent_sfh)

```

### Rental prices

- ACS median rent by tract

```{r acs-r1-rent}

years <- 2010:2020

b25064_vars <- load_variables(2020, "acs5") |> 
  filter(str_sub(name, end =6) %in% "B25064")

b25064_raw <- map_dfr(years, function(yr){
  b25064_pull <- get_acs(
    geography = "tract",
    county = "Chesterfield County",
    state = "VA",
    table = "B25064",
    year = yr,
    survey = "acs5",
    cache_table = TRUE,
    geometry = TRUE
  ) %>%
    mutate(year = yr)
  })

b25064_r1_raw <- b25064_raw |> 
  subset(GEOID %in% r1_tracts$GEOID)

cpi <- read_excel("data/CPI_U_RS.xlsx")
cpi <- cpi |>  
  rename(year = Year,
         priceindex = Index) |> 
  transform(year = as.numeric(year))

r1_rent_cpi <- b25064_r1_raw |> 
    left_join(cpi, by = 'year') |> 
  transform(dollars20 = ((381.2/priceindex)*estimate)) |> 
  select(GEOID, NAME, year, dollars20) |> 
  separate(NAME, into = c("tract", "county", "state"), sep = ",") |> 
  transform(year_char = as.character(year))

# Not sure about the best visualization. Ideally a Shiny app that can tab across years to show the change in median rent.

gg_sf_col_facet(
  r1_rent_cpi,
  col_var = dollars20,
  col_na_rm = TRUE,
  facet_var = year_char
) + 
  scale_fill_viridis_c(option = "magma")


```

- CoStar average asking rent (all units)

```{r costar-r1-rent}

# Use CoStar Multi-family properties search. Draw with polygon tool on map the outline of the Route One census tracts. Filter out properties from previous. Download inflation adjusted history for all years. 

costar_r1_rent <- read_csv("data/costar_r1_rent.csv") |> 
  clean_names() |> 
  mutate(period = case_when(
    period == "2022 Q3 QTD" ~ "2022 Q3",
    TRUE ~ period)) |> 
  mutate(period = yq(period)) |> 
  mutate(current_search = parse_number(current_search))

colnames(costar_r1_rent)[2] <- "rent"

gg_line(costar_r1_rent,
        x_var = period,
        y_var = rent) + 
  scale_x_date()


```
- CoStar average asking rent (by bedroom)
```{r costar-r1-brent}

# Use CoStar Multi-family properties search. Draw with polygon tool on map the outline of the Route One census tracts. Filter out properties from previous. Download inflation adjusted history for all years. 


costar_r1_brent <- read_csv("data/costar_r1_brent.csv") |> 
  clean_names() |> 
  mutate(period = case_when(
    period == "2022 Q3 QTD" ~ "2022 Q3",
    TRUE ~ period)) |> 
  pivot_longer(
    cols = 2:5,
    names_to = "br",
    values_to = "rent"
  ) |> 
  mutate(br = case_when(
    br == "studio" ~ "Studio",
    br == "x1_bed" ~ "One bedroom",
    br == "x2_beds" ~ "Two bedroom",
    br == "x3_beds" ~ "Three bedroom"
  )) |> 
  mutate(period = yq(period)) |> 
  mutate(rent = parse_number(rent))

gg_line_col(costar_r1_brent,
        x_var = period,
        y_var = rent,
        col_var = br) + 
  scale_x_date()

```

- Single-family home rents (active listings and units leased in past 365 days, via MLS)

```{r mls-sfr}

# Use MLS Search RNT search. Filters: Status/Date Range: Active, Leased - 0-365; Map: draw outline for census tracts and export.

mls_r1_sfr <- read_csv("data/mls_r1_sfr.csv") |> 
  clean_names() |> 
  mutate(sales_date = mdy(sales_date)) |> 
  mutate(list_price = parse_number(list_price))

gg_point_col(mls_r1_sfr,
         x_var = sales_date,
         y_var = list_price,
         col_var = type)



```

### Conditions

- ACS rental units by year built
```{r acs-yrblt}

b25036_vars <- load_variables(2020, "acs5") |> 
  filter(str_sub(name, end = 6) %in% "B25036")

b25036_raw <- get_acs(
  geography = "tract",
  county = "Chesterfield County",
  state = "VA",
  table = "B25036",
  year = 2020,
  survey = "acs5",
  cache_table = TRUE,
  geometry = TRUE
  )

b25036_r1_raw <- b25036_raw |> 
  subset(GEOID %in% r1_tracts$GEOID)

# Maybe keep all households in order to do percentages across entire housing stock? Or just rental housing stock?

b25036_vars_cleaned <- b25036_vars |> 
  separate(label, into = c("est", "total", "tenure", "yrblt"), sep = "!!") |> 
  select(variable = name, tenure, yrblt) |> 
  filter(tenure == "Renter occupied:") |> 
  drop_na() |> 
  mutate(tenure = "Renter")

b25036_r1 <- b25036_r1_raw |> 
  right_join(b25036_vars_cleaned, by = "variable")

b25036_r1_grp <- b25036_r1 |> 
  mutate(yrblt = case_when(
    yrblt == "Built 1939 or earlier" ~ "1939 or earlier",
    yrblt == "Built 1940 to 1949" ~ "1940 to 1959",
    yrblt == "Built 1950 to 1959" ~ "1940 to 1959",
    yrblt == "Built 1960 to 1969" ~ "1960 to 1979",
    yrblt == "Built 1970 to 1979" ~ "1960 to 1979",
    yrblt == "Built 1980 to 1989" ~ "1980 to 1999",
    yrblt == "Built 1990 to 1999" ~ "1980 to 1999",
    yrblt == "Built 2000 to 2009" ~ "2000 to 2009",
    yrblt == "Built 2010 to 2013" ~ "2010 or later",
    yrblt == "Built 2014 or later" ~ "2010 or later"
  )) |> 
  mutate(yrgrp = case_when(
    yrblt == "2000 to 2009" ~ yrblt,
    yrblt == "2010 or later" ~ yrblt,
    yrblt == "1980 to 1999" ~ yrblt,
    TRUE ~ "Pre-1980"
  ))

b25036_r1_grp <- b25036_r1_grp |> 
  group_by(yrgrp, NAME) |> 
  summarise(estimate = sum(estimate)) |> 
  filter(yrgrp == "Pre-1980")

# Map showing concentration of pre-1980 rentals.

gg_sf_col(b25036_r1_grp,
          col_var = estimate) +
  scale_fill_viridis_c(option = "magma")
  


```
- CoStar property year built
```{r costar-mf-3}


```

- CoStar rating

```{r costar-mf-3}


```

- MHC ratings from 2016 MHCCV study

## Proximity to amenities

### Public transportation

Compare location of new multifamily development versus older multifamily relative to access to public transportation

- Within or outside of 1/2 mile buffer from GRTC stop

### Schools

Compare location of new multifamily development versus older multifamily relative to access to public schools

- Within or outside of 30 minute drive time

### Grocery stores

Compare location of new multifamily development versus older multifamily relative to access to grocery stores

- Within or outside of 1/2 mile buffer from grocery store

### Healthcare

Compare location of new multifamily development versus older multifamily relative to access to hospitals and urgent care facilities

- Within or outside of 15 minute drive time

### Job centers

TBD, waiting for feedback from county staff

## Public and private investments

- Check CoStar for newest builds/renovations/transactions (commercial properties, too)
- Ask Jessica for what county has had a hand in

Route 10, Bermuda Estates, Falling Creek Rehab, Multifamily Overlay District, R.O.A.R.

### Case study

- Choose an interesting recent residential development
- Add a photo
- Describe development and market it serves
- Rent/sale prices

## Single-family rental versus purchase

- Single-family rental prices from MLS records
- Median home sales price from past 365 days
- Calculate income needed to afford SFR and homeownership
- Use same methodology from Part 1b-4 for homeownership affordability
