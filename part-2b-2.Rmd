# Eastern Hull Street Road corridor analysis {#part-2b-1}

```{r setup}

library(tidycensus)
library(tidyverse)
library(janitor)
library(leaflet)
library(sf)
library(sp)
library(tigris)
library(mapview)
library(simplevis)
library(readxl)
library(ggplot2)
library(lubridate)
library(viridis)
library(tidygeocoder)
library(knitr)
library(crsuggest)
options(tigris_use_cache = TRUE)
remotes::install_github("walkerke/mapboxapi")
library(mapboxapi)
library(rgdal)

```

This section describes the Eastern Hull Street Road corridor in terms of its rental housing market, proximity of rental homes to amenities, recent major investments, and homeownership relative to the price of single-family rentals.

For the purposes of this analysis, this corridor is defined as the Census tracts 1002.05, 1002.06, 1002.08, 1002.09, and 1002.10. These tracts include many of the neighborhoods directly adjacent to Hull Street Road from Chippenham Parkway to Courthouse Road.

```{r hsr-base-map, fig.cap="Eastern Hull Street Road corridor", message=FALSE}

hsr_tracts_list <- c("100205", "100206", "100208", "100209", "100210", "100211")

hsr_tracts <- tracts("VA", "Chesterfield",
                    progress_bar = FALSE) %>% 
  filter(TRACTCE %in% hsr_tracts_list) %>% 
  st_transform(4326)

# Run the mapview and savewidget functions before building the book
# Once the widget is saved, activate the knitr function to embed the map

mapview(hsr_tracts,
          alpha = 0.5,
          col.regions = "cornflowerblue",
          legend = F,
          popup = F,
          label = "NAMELSAD",
          layer.name = "Eastern Hull Street Road corridor census tracts")
#
# htmlwidgets::saveWidget(hsr_map@map, "maps/hsr_map.html")

# knitr::include_url("maps/hsr_map.html", height = "500px")

```

## Rental housing supply

### Number of rental homes

- ACS estimate of renter households

```{r hsr-rhh}

years <- 2010:2020

b25003_vars <- load_variables(2020, "acs5") |> 
  filter(str_sub(name, end = 7) %in% "B25003_")

b25003_raw <- map_dfr(years, function(yr){
  b25003_pull <- get_acs(
    geography = "tract",
    county = "Chesterfield County",
    state = "VA",
    table = "B25003",
    year = yr,
    survey = "acs5",
    cache_table = TRUE,
    geometry = TRUE
  ) |> 
    mutate(year = yr)
  })

b25003_hsr_raw <- b25003_raw |> 
  subset(GEOID %in% hsr_tracts$GEOID)

b25003_vars_cleaned <- b25003_vars |> 
  separate(label, into = c("est", "total", "tenure"), sep = "!!") |> 
  select(variable = name, tenure) |> 
  drop_na() |> 
  mutate(tenure = case_when(
    tenure == "Owner occupied" ~ "Homeowner",
    tenure == "Renter occupied" ~ "Renter"
  )) |> 
  filter(tenure == "Renter")

b25003_hsr <- b25003_hsr_raw |> 
  right_join(b25003_vars_cleaned, by = "variable") |> 
  select(NAME, fips = GEOID, year, tenure, estimate, moe)

b25003_r360 <- b25003_hsr |> 
  group_by(year) |> 
  summarise(estimate = sum(estimate))
  
#Create line graph showing change in renter households across time.
hsr_renters_plot <- gg_line(
  b25003_r360,
  x_var = year,
  y_var = estimate,
  y_breaks_n = 5,
  title = "Renter households",
  x_title = element_blank())

plotly::ggplotly(hsr_renters_plot) %>% 
  plotly_camera()

  
```
- CoStar number of apartments (all types)
- Estimated single-family rentals (county data)

### Rental prices

- ACS median rent by tract
- CoStar average asking rent (all units)
- CoStar average asking rent (by bedroom)
- Single-family home rents (active listings and units leased in past 365 days, via MLS)

### Conditions

- ACS rental units by year built
- CoStar property year built
- CoStar rating

## Proximity to amenities

### Public transportation

Compare location of new multifamily development versus older multifamily relative to access to public transportation

- Within or outside of 1/2 mile buffer from GRTC stop

### Schools

Compare location of new multifamily development versus older multifamily relative to access to public schools

- Within or outside of 30 minute drive time

### Grocery stores

Compare location of new multifamily development versus older multifamily relative to access to grocery stores

- Within or outside of 1/2 mile buffer from grocery store

### Healthcare

Compare location of new multifamily development versus older multifamily relative to access to hospitals and urgent care facilities

- Within or outside of 15 minute drive time

### Job centers

TBD, waiting for feedback from county staff

## Public and private investments

- Check CoStar for newest builds/renovations/transactions (commercial properties, too)
- Ask Jessica for what county has had a hand in

This is recent but just to the west of the corridor area:
https://richmondbizsense.com/2022/06/02/chesterfield-oks-plan-to-redevelop-rockwood-square-shopping-center/

New Manchester Middle School - primary investment in the area in recent years - county investment in school - family growth - https://www.nbc12.com/2020/08/25/chesterfield-holds-virtual-ribbon-cutting-new-school/

New townhome development near Elkhardt?

### Case study

- Choose an interesting recent residential development
- Add a photo
- Describe development and market it serves
- Rent/sale prices

- townhome or existing - Cross Creek or Rollingwood?

## Single-family rental versus purchase

- Single-family rental prices from MLS records
- Median home sales price from past 365 days
- Calculate income needed to afford SFR and homeownership
- Use same methodology from Part 1b-4 for homeownership affordability
