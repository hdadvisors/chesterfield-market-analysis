# Household income {#part-1b-2}

This section provides an analysis of household incomes in Chesterfield County disaggregated by tenure, age, and race/ethnicity. The major data source for this information will be the American Community Survey. Data will be provided at the county and census tract level.

## Background

In 2020, housing expenses increased amid the pandemic to account for nearly 35 percent of household spending â€” [the largest share of average annual expenditures regardless of household type](https://www.bls.gov/news.release/pdf/cesan.pdf). While housing prices have been on the rise, household incomes across the country have not kept pace. This has largely resulted in a higher share of household incomes being spent on basic living expenses.

But like the rest of the country, households in Chesterfield County vary and so do their incomes and expenditures. The following shows how household incomes vary by tenure, age, race and ethnicity. Income disparities exist across the county, and have major implications on the need for housing diversity.


```{r global, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, 
                      message=FALSE, 
                      warning=FALSE, 
                      include=FALSE,
                      eval=FALSE)
library(tidyverse)
library(tidycensus)
library(readxl)
library(ggplot2)
library(plotly)

```

## Tenure

A majority of Chesterfield residents are homeowners, but the number of renters has 
been on the rise over the past decade. The increase in renters can be attributed to 
the growing cost of homeownership and changing preferences among individuals and families. 

But as of 2020, the renter median household income is nearly half (55%) that of a 
typical homeowner's household income \$53,147 compared to  $96,296. While the median 
renter income has been on the rise and homeowner incomes have declined over the past decade, 
the income gap of nearly $40,000 has remained steady.

```{r tenure, message=FALSE, warning=FALSE}

years <- 2010:2020

b25119_vars <- load_variables(2010, "acs5") %>%
  filter(str_sub(name, end = 6) %in% "B25119")

b25119_raw <- map_dfr(years, function(yr){
  b25119_pull <- get_acs(
    geography = "county",
    county = "Chesterfield County",
    state = "VA",
    table = "B25119",
    year = yr,
    survey = "acs5" # Using 5-year because 1-year ACS isn't available?
  ) %>%
    mutate(year = yr)
  })

b25119_vars_cleaned <- b25119_vars %>%
  separate(label, into = c("est", "income", "tenure"), sep = "!!") %>% 
  select(variable = name, tenure) %>%
  mutate(tenure = case_when(
    tenure == "Total" ~ "All households",
    tenure == "Owner occupied (dollars)" ~ "Homeowner",
    tenure == "Renter occupied (dollars)" ~ "Renter"
  ))

b25119_data <- b25119_raw %>%
  right_join(b25119_vars_cleaned, by = "variable") %>%
  select(NAME, year, tenure, estimate, moe) %>%
  group_by(year, tenure) %>%
  summarise(
    estimate = sum(estimate),
    moe = moe_sum(moe, estimate)
  ) %>% 
  ungroup() %>% 
  mutate(cv = ((moe/1.645)/estimate)*100) %>% 
  mutate(reliability = case_when(
    cv < 15 ~ "High reliability",
    cv >= 15 & cv <= 30 ~ "Medium reliability",
    cv > 30 ~ "Low reliability")
  )

cpi <- read_excel("data/CPI_U_RS.xlsx")
cpi <- cpi %>% 
  rename(year = Year,
         priceindex = Index) %>%
  transform(year = as.numeric(year))

b25119_cpi <- b25119_data %>%
    left_join(cpi, by = 'year') %>%
  transform(dollars20 = ((381.2/priceindex)*estimate)) %>%
  select(year, tenure, dollars20, moe, reliability) %>%
  subset(tenure != "All households")

tenure <- ggplot(b25119_cpi, aes(x=year, y=dollars20, group=tenure)) +
  geom_line(aes(color=tenure)) +
  labs(
    x = NULL,
    y = NULL,
    title = "Median household income by tenure",
    subtitle = "From 2010 to 2020 in Chesterfield County",
    source = "U.S. Census Bureau, American Community Survey, 2010-2020 5-year estimates, Table B19049."
  ) +
  scale_y_continuous(labels=scales::dollar_format()) +
  scale_x_continuous(breaks = 2010:2020)
  

ggplotly(tenure)

```

## Age

While younger households generally have less income because they are typically getting 
started in their careers, senior households can face similar challenges as they approach 
retirement age and transition to fixed-incomes. This is evident in Chesterfield County where 
households both under 25 and 65 and older have substantially lower incomes.

The 45 to 64 year age group has a high median household income nearing \$100,000 in 2020. This 
age group represents a significant number of Generation X'ers and baby boomers who have chosen to 
live in the county. Millennial households in the county also have high incomes ($87,328).

Chesterfield seniors in 2020 had a median household income of \$61,777. Although this was the only 
age group to see a moderate increase (11 percent) in nedian household income, senior incomes are still
significantly less than their older adult couunterparts. This translates to less income to compete for housing in the Chesterfield market.

At the opposite end of the spectrum, households under 25 have seen decreasing incomes --- going 
from \$48,591 in 2010 to \$40,881 in 2020, a 16 percent decrease. Lower incomes among Generation Z 
may have major implications on the need for more rental and starter home options amid rising costs.

```{r age}

years <- 2010:2020

b19049_vars <- load_variables(2010, "acs5") %>%
  filter(str_sub(name, end = 6) %in% "B19049")

b19049_raw <- map_dfr(years, function(yr){
  b25119_pull <- get_acs(
    geography = "county",
    county = "Chesterfield County",
    state = "VA",
    table = "B19049",
    year = yr,
    survey = "acs5"
  ) %>%
    mutate(year = yr)
  })

b19049_vars_cleaned <- b19049_vars %>%
  separate(label, into = c("est", "income", "age"), sep = "!!") %>% 
  select(variable = name, age) %>%
  mutate(age = case_when(
    age == "Total" ~ "All",
    age == "Householder under 25 years" ~ "Under 25 years",
    age == "Householder 25 to 44 years" ~ "25 to 44 years",
    age == "Householder 45 to 64 years"~ "45 to 64 years",
    age == "Householder 65 years and over"~ "65 years and over"
  ))

b19049_data <- b19049_raw %>%
  right_join(b19049_vars_cleaned, by = "variable") %>%
  select(NAME, year, age, estimate, moe) %>%
  group_by(year, age) %>%
  summarise(
    estimate = sum(estimate),
    moe = moe_sum(moe, estimate)
  ) %>% 
  ungroup() %>% 
  mutate(cv = ((moe/1.645)/estimate)*100) %>% 
  mutate(reliability = case_when(
    cv < 15 ~ "High reliability",
    cv >= 15 & cv <= 30 ~ "Medium reliability",
    cv > 30 ~ "Low reliability")
  )

cpi <- read_excel("data/CPI_U_RS.xlsx")
cpi <- cpi %>% 
  rename(year = Year,
         priceindex = Index) %>%
  transform(year = as.numeric(year))

b19049_cpi <- b19049_data %>%
    left_join(cpi, by = 'year') %>%
  transform(dollars20 = ((381.2/priceindex)*estimate)) %>%
  select(year, age, dollars20, moe, reliability) %>%
  subset(age != "All")

age <- ggplot(b19049_cpi, aes(x=year, y=dollars20, group=age)) +
  geom_line(aes(color=age)) +
  labs(
    x = NULL,
    y = NULL,
    title = "Median household income by age",
    subtitle = "From 2010 to 2020 in Chesterfield County",
    source = "U.S. Census Bureau, American Community Survey, 2010-2020 5-year estimates, Table B19049."
  ) +
  scale_y_continuous(labels=scales::dollar_format()) +
  scale_x_continuous(breaks = 2010:2020)


ggplotly(age)

```

## Race/ethnicity

The racial wealth gap has been reported on in numerous studies and articles over the past decades. This wealth gap is most pronounced between Black and white households in America and can be attributed to centuries of discriminatory practices. In Chesterfield County,...
```{r race}

years <- 2010:2020

b19013 <- c("B19013", paste0("B19013", LETTERS[2:9]))

concept_to_race <- function(x) {
  out <- x %>%
    str_remove_all("MEDIAN HOUSEHOLD INCOME IN THE PAST 12 MONTHS \\(\\IN 2019 INFLATION-ADJUSTED DOLLARS\\)\\ \\(|\\)") %>%
    str_to_title()
}

b19013_vars <- load_variables(2019, "acs5") %>%
  filter(str_sub(name, end = 6) %in% b19013) %>%
  filter(str_detect(name, "A") == FALSE) %>%
  mutate(race = concept_to_race(concept)) %>%
  mutate(race = case_when(
    race == "Median Household Income In The Past 12 Months (In 2019 Inflation-Adjusted Dollars" ~ "All",
    TRUE ~ race)) %>%
    mutate(across(where(is.character), str_trim)) %>%
  mutate(across(.fns = ~str_remove_all(.x, "Householder")),
         across(.fns = ~str_remove_all(.x, "Alone")),
         across(.fns = ~str_trim(.x, side = "right"))) %>%
  mutate(race = case_when(
    race == "Two Or More Races" ~ "Multiracial",
    race == "White, Not Hispanic Or Latino" ~ "White, non-Hispanic",
    TRUE ~ race))
  

b19013_raw <- map_dfr(b19013, function(tb){
  yearly_data <- map_dfr(years, function(yr){
  b25119_pull <- get_acs(
    geography = "county",
    county = "Chesterfield County",
    state = "VA",
    table = tb,
    year = yr,
    survey = "acs5"
  ) %>%
    mutate(year = yr)
  })
  yearly_data
})

b19013_vars_cleaned <- b19013_vars %>%
  select(variable = name, race)

b19013_data <- b19013_raw %>%
  right_join(b19013_vars_cleaned, by = "variable") %>%
  select(NAME, year, race, estimate, moe) %>%
  group_by(year, race) %>%
  summarise(
    estimate = sum(estimate),
    moe = moe_sum(moe, estimate)
  ) %>% 
  ungroup() %>% 
  mutate(cv = ((moe/1.645)/estimate)*100) %>% 
  mutate(reliability = case_when(
    cv < 15 ~ "High reliability",
    cv >= 15 & cv <= 30 ~ "Medium reliability",
    cv > 30 ~ "Low reliability")
  )

cpi <- read_excel("data/CPI_U_RS.xlsx")
cpi <- cpi %>% 
  rename(year = Year,
         priceindex = Index) %>%
  transform(year = as.numeric(year))

b19013_cpi <- b19013_data %>%
    left_join(cpi, by = 'year') %>%
  transform(dollars20 = ((381.2/priceindex)*estimate))%>%
  select(year, race, dollars20, moe, reliability) %>%
  subset(race != "All") %>%
  subset(race != "American Indian And Alaska Native") %>%
  subset(race != "Native Hawaiian And Other Pacific Islander") %>%
  subset(race != "Some Other Race")

race <- ggplot(b19013_cpi, aes(x=year, y=dollars20, group=race)) +
  geom_line(aes(color=race)) +
  labs(
    x = NULL,
    y = NULL,
    title = "Median household income by race and ethnicity",
    subtitle = "From 2010 to 2020 in Chesterfield County",
    source = "U.S. Census Bureau, American Community Survey, 2010-2020 5-year estimates, Table B19013B-I."
  ) +
  scale_y_continuous(labels=scales::dollar_format()) +
  scale_x_continuous(breaks = 2010:2020)
  

ggplotly(race)

```

## Takeaways

[reserved]